{% extends 'base.html' %}
{% load static %}

{% block title %}{{ meeting.title }} - Meeting Details - Robert Sichomba{% endblock title %}

{% block meta_description %}{{ meeting.description|truncatechars:160 }}{% endblock meta_description %}

{% block content %}
    {# Meeting Detail Section #}
    <section class="py-5">
        <div class="container my-5">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'meetings_list' %}">Meetings & Events</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{ meeting.title }}</li>
                </ol>
            </nav>

            <div class="row gx-5 align-items-center">
                {# Meeting Banner Image Column #}
                <div class="col-md-5 text-center mb-4 mb-md-0" data-animate>
                    {% if meeting.image %}
                        <img src="{{ meeting.image.url }}" class="img-fluid rounded shadow-lg meeting-detail-banner" alt="Banner for {{ meeting.title }}">
                    {% else %}
                        <img src="{% static 'images/default_meeting_banner.jpg' %}" class="img-fluid rounded shadow-lg meeting-detail-banner" alt="Default meeting banner">
                    {% endif %}
                </div>

                {# Meeting Key Details Column #}
                <div class="col-md-7" data-animate>
                    <h1 class="display-5 fw-bold mb-3">{{ meeting.title }}</h1>
                    <p class="lead text-muted mb-4">
                        <i class="far fa-calendar-alt me-2"></i> **Date & Time:** <span class="fw-bold">{{ meeting.date_time|date:"F d, Y" }} at {{ meeting.date_time|date:"P" }}</span>
                        {% if meeting.location %}<br><i class="fas fa-map-marker-alt me-2"></i> **Location:** <span class="fw-bold">{{ meeting.location }}</span>{% endif %}
                    </p>

                    <div class="mb-4">
                        {% if meeting.tags.all %}
                        <h6 class="fw-bold">Topics:</h6>
                        {% for tag in meeting.tags.all %}
                            {# You might link these to a filtered meetings list by tag #}
                            <span class="badge bg-secondary text-decoration-none me-1 mb-1">{{ tag.name }}</span>
                        {% endfor %}
                        {% endif %}
                    </div>

                    {% if meeting.date_time > current_time %} {# Check if meeting is in the future #}
                        {% if meeting.external_link %}
                            <a href="{{ meeting.external_link }}" target="_blank" rel="noopener noreferrer" class="btn btn-primary btn-lg me-3">
                                Register/Join Event <i class="fas fa-external-link-alt ms-2"></i>
                            </a>
                        {% else %}
                             <span class="btn btn-primary btn-lg me-3 disabled">Upcoming Event</span>
                        {% endif %}
                    {% else %} {# Meeting is in the past #}
                        {% if meeting.recording_link %}
                            <a href="{{ meeting.recording_link }}" target="_blank" rel="noopener noreferrer" class="btn btn-success btn-lg me-3">
                                Watch Recording <i class="fas fa-video ms-2"></i>
                            </a>
                        {% else %}
                            <span class="btn btn-secondary btn-lg me-3 disabled">Event Concluded</span>
                        {% endif %}
                    {% endif %}

                    <a href="{% url 'meetings_list' %}" class="btn btn-outline-secondary btn-lg">
                        <i class="fas fa-arrow-left me-2"></i> Back to All Events
                    </a>
                </div>
            </div>

            <hr class="my-5">

            {# Full Meeting Description/Content #}
            <div class="meeting-full-description" data-animate>
                <h3 class="fw-bold mb-4">About This Event</h3>
                <div class="lead-text">
                    {{ meeting.description|safe }} {# Use |safe if your description contains HTML #}
                </div>
            </div>

            {# --- Access Level Warning (if not public) --- #}
            {% if meeting.access_level != 'public' %}
                {% if not user.is_authenticated %}
                <div class="alert alert-warning mt-5 text-center" role="alert">
                    <i class="fas fa-lock me-2"></i> This content is for **Registered Users Only**. Please <a href="{% url 'login' %}" class="alert-link">log in</a> or <a href="{% url 'signup' %}" class="alert-link">sign up</a> to view the full details.
                </div>
                {% elif meeting.access_level == 'private' and not user.is_superuser and not user.is_staff %}
                <div class="alert alert-danger mt-5 text-center" role="alert">
                    <i class="fas fa-user-lock me-2"></i> This content is **Private (Admin Only)**. You do not have permission to view it.
                </div>
                {% endif %}
            {% endif %}

        </div>
    </section>

    {# Optional: Related Meetings Section #}
    {#
    <section class="py-5 bg-light" data-animate>
        <div class="container my-5">
            <h3 class="text-center fw-bold mb-5">More from Robert Sichomba</h3>
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                {# Loop through related meetings or other relevant content (e.g., recent blog posts) #}
            </div>
        </div>
    </section>
    #}

    {# Call to Action for Contact/Scheduling #}
    <section class="py-5 bg-dark text-white text-center" data-animate>
        <div class="container my-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="fw-bold mb-4">Have Questions or Want to Collaborate?</h2>
                <p class="lead mb-4">
                    Feel free to reach out if you have questions about this event, or if you'd like to discuss a potential collaboration.
                </p>
                <a href="{% url 'contact' %}" class="btn btn-primary btn-lg me-3">Get in Touch <i class="fas fa-envelope ms-2"></i></a>
                <a href="{% url 'projects_list' %}" class="btn btn-outline-light btn-lg">Explore My Projects <i class="fas fa-laptop-code ms-2"></i></a>
            </div>
        </div>
    </section>
{% endblock content %}

{% block extra_head %}
<style>
    .meeting-detail-banner {
        max-width: 450px; /* Adjust as needed */
        height: auto;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    .lead-text p { /* For styling the actual description content */
        font-size: 1.1rem;
        line-height: 1.8;
        color: #495057;
    }
</style>
{% endblock extra_head %}