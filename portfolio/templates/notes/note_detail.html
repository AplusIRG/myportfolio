{% extends 'base.html' %}
{% load static %}

{% block title %}{{ note.title }} - My Notes - Robert Sichomba{% endblock title %}

{% block meta_description %}{{ note.summary|truncatechars:160 }}{% endblock meta_description %}

{% block content %}
    {# Note Detail Section #}
    <section class="py-5">
        <div class="container my-5">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'notes_list' %}">Notes & Insights</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{ note.title }}</li>
                </ol>
            </nav>

            <div class="row gx-5 align-items-start"> {# Use align-items-start to keep content at the top #}
                {# Note Header and Image (if applicable) #}
                <div class="col-md-8 offset-md-2 text-center mb-4" data-animate>
                    <h1 class="display-4 fw-bold mb-3">{{ note.title }}</h1>
                    <p class="lead text-muted mb-4">
                        <i class="far fa-calendar-alt me-2"></i> Published: {{ note.created_at|date:"F d, Y" }}
                        {% if note.category %}<span class="ms-3"><i class="fas fa-tag me-2"></i> Category: {{ note.category }}</span>{% endif %}
                    </p>
                    {% if note.image %}
                        <img src="{{ note.image.url }}" class="img-fluid rounded shadow-lg mb-4 note-detail-banner" alt="Banner for {{ note.title }}">
                    {% endif %}
                </div>
            </div>

            <div class="row justify-content-center">
                <div class="col-lg-8" data-animate>
                    {# Note Content #}
                    <div class="note-full-content mb-5">
                        <div class="lead-text">
                            {{ note.content|safe }} {# Use |safe if your content contains HTML #}
                        </div>
                    </div>

                    {% if note.tags.all %}
                    <div class="mb-4">
                        <h6 class="fw-bold">Tags:</h6>
                        {% for tag in note.tags.all %}
                            {# Link to a tag-filtered notes list if you implement it #}
                            <span class="badge bg-secondary text-decoration-none me-1 mb-1">{{ tag.name }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}

                    <div class="d-flex justify-content-between align-items-center">
                        <a href="{% url 'notes_list' %}" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-arrow-left me-2"></i> Back to All Notes
                        </a>
                        {# Optional: Edit/Share buttons if applicable, e.g., for admin users #}
                    </div>

                    {# --- Access Level Warning (if not public) --- #}
                    {% if note.access_level != 'public' %}
                        {% if not user.is_authenticated %}
                        <div class="alert alert-warning mt-5 text-center" role="alert">
                            <i class="fas fa-lock me-2"></i> This content is for **Registered Users Only**. Please <a href="{% url 'login' %}" class="alert-link">log in</a> or <a href="{% url 'signup' %}" class="alert-link">sign up</a> to view the full details.
                        </div>
                        {% elif note.access_level == 'private' and not user.is_superuser and not user.is_staff %}
                        <div class="alert alert-danger mt-5 text-center" role="alert">
                            <i class="fas fa-user-lock me-2"></i> This content is **Private (Admin Only)**. You do not have permission to view it.
                        </div>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    {# Optional: Related Notes/Content Section #}
    {#
    <section class="py-5 bg-light" data-animate>
        <div class="container my-5">
            <h3 class="text-center fw-bold mb-5">Related Notes & Resources</h3>
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                {# Loop through related notes here #}
            </div>
        </div>
    </section>
    #}

    {# Call to Action for Other Resources #}
    <section class="py-5 bg-dark text-white text-center" data-animate>
        <div class="container my-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="fw-bold mb-4">Explore More Insights</h2>
                <p class="lead mb-4">
                    My blog offers more in-depth articles, and my projects showcase practical applications of these concepts.
                </p>
                <a href="{% url 'blog_list' %}" class="btn btn-primary btn-lg me-3">Visit My Blog <i class="fas fa-newspaper ms-2"></i></a>
                <a href="{% url 'projects_list' %}" class="btn btn-outline-light btn-lg">View Projects <i class="fas fa-laptop-code ms-2"></i></a>
            </div>
        </div>
    </section>
{% endblock content %}

{% block extra_head %}
<style>
    .note-detail-banner {
        max-height: 400px; /* Max height for banners */
        object-fit: cover; /* Ensures image covers area without distortion */
        width: 100%; /* Make image span full width of its column */
    }
    .lead-text p { /* For styling the actual description content */
        font-size: 1.1rem;
        line-height: 1.8;
        color: #495057;
    }
    .note-full-content ul, .note-full-content ol {
        padding-left: 20px;
        margin-bottom: 1rem;
    }
    .note-full-content li {
        margin-bottom: 0.5rem;
    }
</style>
{% endblock extra_head %}