{% extends 'base.html' %}
{% load static %}

{% block title %}My Projects - Robert Sichomba's Portfolio{% endblock title %}

{% block meta_description %}Explore Robert Sichomba's diverse portfolio of projects, including data analysis, machine learning models, web applications, and educational software solutions. Filter by technology and domain.{% endblock meta_description %}

{# No extra_head or extra_js needed here, as global styles/scripts handle most functionality #}

{% block content %}
    {# Hero Section for Projects #}
    <section class="hero d-flex align-items-center justify-content-center text-center" style="padding-top: 8rem; padding-bottom: 5rem;">
        <div class="container" data-animate>
            <h1 class="display-3 fw-bold mb-3">My Projects & Solutions</h1>
            <p class="lead mb-4 col-lg-8 mx-auto">
                A showcase of my work, demonstrating practical applications of data science, machine learning, and web development.
            </p>
        </div>
    </section>

    {# Projects List with Filtering Section #}
    <section class="py-5" data-animate>
        <div class="container my-5">
            <h2 class="text-center fw-bold mb-5">Browse My Portfolio</h2>

            {# Project Filtering (Dynamic) #}
            <div class="d-flex flex-wrap justify-content-center gap-2 mb-5 filter-buttons">
                <button type="button" class="btn btn-outline-primary filter-btn active" data-filter="all">All Projects</button>
                <button type="button" class="btn btn-outline-primary filter-btn" data-filter="machine-learning">Machine Learning</button>
                <button type="button" class="btn btn-outline-primary filter-btn" data-filter="data-analysis">Data Analysis</button>
                <button type="button" class="btn btn-outline-primary filter-btn" data-filter="web-development">Web Development</button>
                <button type="button" class="btn btn-outline-primary filter-btn" data-filter="education">Education Tech</button>
                {# Add more filter buttons based on your project categories/technologies #}
            </div>

            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="project-list">
                {# Loop through projects here (example static posts below) #}
                {% for project in projects %} {# Assuming 'projects' is passed from your Django view #}
                <div class="col project-item" data-category="{{ project.category_slug }}"> {# Add data-category for filtering #}
                    <div class="project-card h-100 position-relative d-flex flex-column">
                        {% if project.is_featured %}
                            <span class="project-badge">Featured</span>
                        {% elif project.is_latest %}
                            <span class="project-badge">Latest</span>
                        {% endif %}
                        <img src="{% static project.image %}" class="card-img-top mb-3" alt="{{ project.title }}">
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="card-title fw-bold">{{ project.title }}</h5>
                            <p class="card-text text-muted mb-2">{{ project.sub_category }}</p> {# e.g., "Machine Learning | NLP" #}
                            <p class="card-text">{{ project.summary }}</p>
                            <div class="tech-tags mt-auto pt-3"> {# Push tags to bottom and allow wrapping #}
                                {% for tag in project.tags.all %} {# Assuming a ManyToManyField for tags #}
                                    <span>{{ tag.name }}</span>
                                {% endfor %}
                                {% comment %} Static example tags {% endcomment %}
                                {# <span>Python</span><span>Django</span><span>Pandas</span> #}
                            </div>
                            <div class="mt-3">
                                <a href="{% url 'project_detail' project.slug %}" class="btn btn-project">
                                    <i class="fas fa-arrow-right"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-12 text-center">
                    <p class="lead">No projects found yet. Check back soon for new additions!</p>
                    <a href="{% url 'contact' %}" class="btn btn-primary mt-3">Propose a Project <i class="fas fa-lightbulb ms-2"></i></a>
                </div>
                {% endfor %}

                {# Static Examples (Remove/Replace with Django loop later) #}
                {#
                <div class="col project-item" data-category="machine-learning data-analysis">
                    <div class="project-card h-100 position-relative d-flex flex-column">
                        <span class="project-badge">Featured</span>
                        <img src="{% static 'images/project_potability.jpg' %}" class="card-img-top mb-3" alt="Drinking Water Potability Project">
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="card-title fw-bold">Drinking Water Potability Classification</h5>
                            <p class="card-text text-muted mb-2">Machine Learning | Data Analysis</p>
                            <p class="card-text">Developed an ML model to classify water potability based on various chemical properties. Essential for public health insights.</p>
                            <div class="tech-tags mt-auto pt-3">
                                <span>Python</span><span>Scikit-learn</span><span>Pandas</span><span>Streamlit</span>
                            </div>
                            <div class="mt-3">
                                <a href="{% url 'project_detail' 'water-potability-classification' %}" class="btn btn-project">
                                    <i class="fas fa-arrow-right"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col project-item" data-category="web-development education">
                    <div class="project-card h-100 position-relative d-flex flex-column">
                        <span class="project-badge">Latest</span>
                        <img src="{% static 'images/project_quiz_app.jpg' %}" class="card-img-top mb-3" alt="Interactive Quiz App">
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="card-title fw-bold">Interactive Quiz & Exam Prep Platform</h5>
                            <p class="card-text text-muted mb-2">Web Development | Educational Software</p>
                            <p class="card-text">A dynamic web application designed to help students prepare for exams with customizable quizzes and performance tracking.</p>
                            <div class="tech-tags mt-auto pt-3">
                                <span>Django</span><span>Python</span><span>JavaScript</span><span>PostgreSQL</span>
                            </div>
                            <div class="mt-3">
                                <a href="{% url 'project_detail' 'interactive-quiz-platform' %}" class="btn btn-project">
                                    <i class="fas fa-arrow-right"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col project-item" data-category="data-analysis machine-learning">
                    <div class="project-card h-100 position-relative d-flex flex-column">
                        <img src="{% static 'images/project_sales_forecasting.jpg' %}" class="card-img-top mb-3" alt="Retail Sales Forecasting">
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="card-title fw-bold">Retail Sales Forecasting Model</h5>
                            <p class="card-text text-muted mb-2">Data Analysis | Machine Learning</p>
                            <p class="card-text">Developed a time-series forecasting model to predict retail sales, optimizing inventory and supply chain management.</p>
                            <div class="tech-tags mt-auto pt-3">
                                <span>Python</span><span>Prophet</span><span>SQL</span><span>Power BI</span>
                            </div>
                            <div class="mt-3">
                                <a href="{% url 'project_detail' 'retail-sales-forecasting' %}" class="btn btn-project">
                                    <i class="fas fa-arrow-right"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col project-item" data-category="web-development">
                    <div class="project-card h-100 position-relative d-flex flex-column">
                        <img src="{% static 'images/project_ecom.jpg' %}" class="card-img-top mb-3" alt="E-commerce Platform">
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="card-title fw-bold">Custom E-commerce Solution</h5>
                            <p class="card-text text-muted mb-2">Web Development</p>
                            <p class="card-text">Designed and built a full-featured e-commerce platform with secure payments, order management, and user authentication.</p>
                            <div class="tech-tags mt-auto pt-3">
                                <span>Django</span><span>Stripe</span><span>Bootstrap</span><span>Docker</span>
                            </div>
                            <div class="mt-3">
                                <a href="{% url 'project_detail' 'custom-ecommerce-solution' %}" class="btn btn-project">
                                    <i class="fas fa-arrow-right"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                #}
            </div>
        </div>
    </section>

    {# Call to Action / Contact #}
    <section class="py-5 bg-dark text-white text-center" data-animate>
        <div class="container my-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="fw-bold mb-4">Have an Exciting Project in Mind?</h2>
                <p class="lead mb-4">
                    I'm always eager to collaborate on innovative ideas and bring complex concepts to life through data and technology.
                </p>
                <a href="{% url 'contact' %}" class="btn btn-primary btn-lg me-3">Let's Discuss <i class="fas fa-comment-dots ms-2"></i></a>
                <a href="{% url 'about' %}" class="btn btn-outline-light btn-lg">Learn More About Me <i class="fas fa-user ms-2"></i></a>
            </div>
        </div>
    </section>
{% endblock content %}

{% block extra_js %}
{# Specific JavaScript for Project Filtering #}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filterButtons = document.querySelectorAll('.filter-btn');
        const projectItems = document.querySelectorAll('.project-item');
        const projectListContainer = document.getElementById('project-list');

        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                filterButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to the clicked button
                this.classList.add('active');

                const filterValue = this.dataset.filter;

                // Add a temporary class to enable smooth transition/animation for hiding
                projectListContainer.classList.add('filtering-active');

                // Hide all projects first
                projectItems.forEach(item => {
                    item.style.display = 'none';
                    item.classList.remove('animate'); // Reset animation for re-showing
                });

                // Small delay to ensure display:none takes effect before showing
                setTimeout(() => {
                    projectItems.forEach(item => {
                        const itemCategories = item.dataset.category.split(' '); // Handle multiple categories

                        if (filterValue === 'all' || itemCategories.includes(filterValue)) {
                            item.style.display = 'block'; // Or 'flex' if it's a flex item
                            // Re-trigger animation by removing/adding data-animate or forcing reflow
                            item.classList.remove('animate'); // Ensure it's not 'animate' state
                            void item.offsetWidth; // Trigger reflow
                            item.classList.add('animate'); // Re-add animation
                        }
                    });
                    projectListContainer.classList.remove('filtering-active');
                }, 100); // Adjust delay as needed
            });
        });

        // Add a subtle transition for filtering container (optional, for visual polish)
        const style = document.createElement('style');
        style.innerHTML = `
            #project-list {
                transition: opacity 0.3s ease-in-out;
            }
            #project-list.filtering-active {
                opacity: 0;
            }
        `;
        document.head.appendChild(style);
    });
</script>
{% endblock extra_js %}