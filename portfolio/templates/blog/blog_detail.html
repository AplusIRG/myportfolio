{% extends 'base.html' %}
{% load static %}

{% block title %}{{ blog_post.title }} - Robert Sichomba's Blog{% endblock title %}

{% block meta_description %}{{ blog_post.summary }}{% endblock meta_description %}

{# You might want to add Open Graph/Twitter Card meta tags for better social sharing #}
{% block extra_head %}
    <meta property="og:title" content="{{ blog_post.title }}">
    <meta property="og:description" content="{{ blog_post.summary }}">
    <meta property="og:image" content="{% if blog_post.image %}{{ request.scheme }}://{{ request.get_host }}{{ blog_post.image.url }}{% else %}{% static 'images/default_blog_image.jpg' %}{% endif %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta name="twitter:card" content="summary_large_image">
    {# Add other specific meta tags if needed #}
{% endblock extra_head %}

{% block content %}
    {# Blog Post Hero Section #}
    <section class="hero d-flex align-items-center justify-content-center text-center py-5" style="padding-top: 8rem; padding-bottom: 5rem; background-color: #f8f9fa;">
        <div class="container" data-animate>
            <h1 class="display-4 fw-bold mb-3">{{ blog_post.title }}</h1>
            <p class="lead text-muted mb-4">
                By <span class="fw-bold">{{ blog_post.author.username|default:"Robert Sichomba" }}</span> on {{ blog_post.created_at|date:"F d, Y" }}
                {% if blog_post.updated_at != blog_post.created_at %}
                (Last updated: {{ blog_post.updated_at|date:"F d, Y" }})
                {% endif %}
            </p>
            {% if blog_post.image %}
                <img src="{% static blog_post.image.url %}" class="img-fluid rounded shadow-sm mb-4" alt="{{ blog_post.title }}" style="max-height: 450px; object-fit: cover;">
            {% endif %}
        </div>
    </section>

    {# Blog Post Content Section #}
    <section class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8" data-animate>
                    <article class="blog-content">
                        {# Display the full content of the blog post #}
                        {{ blog_post.content|safe }} {# Assuming 'content' field stores HTML or markdown rendered to HTML #}
                    </article>

                    {# Tags / Categories #}
                    {% if blog_post.tags.all %}
                        <div class="mt-5 border-top pt-4">
                            <h5 class="fw-bold mb-3"><i class="fas fa-tags me-2"></i>Tags:</h5>
                            {% for tag in blog_post.tags.all %}
                                <span class="badge bg-primary-subtle text-primary-emphasis rounded-pill me-2 mb-2">{{ tag.name }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}

                    {# Author Info (Optional) #}
                    <div class="mt-5 border-top pt-4 d-flex align-items-center">
                        <img src="{% static 'images/robert_sichomba.jpg' %}" alt="Robert Sichomba" class="rounded-circle me-3" style="width: 80px; height: 80px; object-fit: cover;">
                        <div>
                            <h5 class="fw-bold mb-0">About the Author: Robert Sichomba</h5>
                            <p class="text-muted mb-0">
                                BSc Physicist| MSc Data Scientist and Exploration Geologist| Developer, and passionate educator. I enjoy sharing my journey and insights.
                                <a href="{% url 'about' %}" class="ms-2">Read More</a>
                            </p>
                        </div>
                    </div>

                    {# Social Sharing Buttons #}
                    <div class="mt-5 border-top pt-4 text-center">
                        <h5 class="fw-bold mb-3">Share This Post:</h5>
                        {% with current_url=request.build_absolute_uri %}
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ current_url|urlencode }}&title={{ blog_post.title|urlencode }}&summary={{ blog_post.summary|urlencode }}" target="_blank" class="btn btn-outline-secondary me-2 mb-2">
                            <i class="fab fa-linkedin me-1"></i> LinkedIn
                        </a>
                        <a href="https://twitter.com/intent/tweet?url={{ current_url|urlencode }}&text={{ blog_post.title|urlencode }}&hashtags={% for tag in blog_post.tags.all %}{{ tag.name|slugify }}{% if not forloop.last %},{% endif %}{% endfor %}" target="_blank" class="btn btn-outline-secondary me-2 mb-2">
                            <i class="fab fa-twitter me-1"></i> Twitter
                        </a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u={{ current_url|urlencode }}" target="_blank" class="btn btn-outline-secondary me-2 mb-2">
                            <i class="fab fa-facebook-f me-1"></i> Facebook
                        </a>
                        <a href="mailto:?subject={{ blog_post.title|urlencode }}&body=Check%20out%20this%20blog%20post:%20{{ blog_post.title|urlencode }}%0A{{ current_url|urlencode }}" class="btn btn-outline-secondary me-2 mb-2">
                            <i class="fas fa-envelope me-1"></i> Email
                        </a>
                        {% endwith %}
                    </div>

                    {# Next/Previous Post Navigation (Requires logic in view to pass next_post and prev_post) #}
                    <div class="d-flex justify-content-between mt-5 border-top pt-4">
                        {% if prev_post %}
                            <a href="{% url 'blog_detail' prev_post.slug %}" class="btn btn-outline-dark">
                                <i class="fas fa-arrow-left me-2"></i> Previous Post
                            </a>
                        {% else %}
                            <span></span> {# Keep space for alignment #}
                        {% endif %}
                        {% if next_post %}
                            <a href="{% url 'blog_detail' next_post.slug %}" class="btn btn-outline-dark">
                                Next Post <i class="fas fa-arrow-right ms-2"></i>
                            </a>
                        {% endif %}
                    </div>

                    {# Comments Section (Placeholder) #}
                    <div class="mt-5 border-top pt-4">
                        <h4 class="fw-bold mb-4">Comments</h4>
                        <div class="alert alert-info" role="alert">
                            Leave a comment...
                        </div>
                        {# Example comment display (loop through comments in context) #}
                        
                        <div class="mb-4">
                            <strong>Joseph Kachingwe</strong> <span class="text-muted">- June 1, 2025</span>
                            <p class="mb-0">Great post, very insightful!</p>
                        </div>
                        <form>
                            <textarea class="form-control mb-3" rows="3" placeholder="Leave a comment..."></textarea>
                            <button type="submit" class="btn btn-primary">Submit Comment</button>
                        </form>
                        
                    </div>

                </div>
            </div>
        </div>
    </section>

    {# Related Posts (Optional) #}
    {# You might want to add a section here to show related blog posts based on tags or categories. #}

{% endblock content %}